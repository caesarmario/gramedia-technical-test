{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.13", "generated_at": "2025-11-07T17:11:30.926587Z", "invocation_id": "7ffdb05f-49af-4ef5-8b7d-2f92e24fb405", "invocation_started_at": "2025-11-07T17:11:29.821789Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.506676Z", "completed_at": "2025-11-07T17:11:30.515426Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.516485Z", "completed_at": "2025-11-07T17:11:30.516508Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04063820838928223, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.l1_carts_quantity_positive", "compiled": true, "compiled_code": "-- ##############################################\n-- Gramedia Digital - Data Engineer Take Home Test\n-- dbt sql script to test l1.carts quantity not negative\n-- Mario Caesar // caesarmario87@gmail.com\n-- ##############################################\n\nselect *\nfrom \"dwh\".\"l1\".\"carts\"\nwhere quantity is not null\n  and quantity < 1", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.503853Z", "completed_at": "2025-11-07T17:11:30.516072Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.517451Z", "completed_at": "2025-11-07T17:11:30.517464Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.042699575424194336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.l1_carts_compound_pk", "compiled": true, "compiled_code": "-- ##############################################\n-- Gramedia Digital - Data Engineer Take Home Test\n-- dbt sql script to test l1.carts uniqueness cart id & product id\n-- Mario Caesar // caesarmario87@gmail.com\n-- ##############################################\n\nwith dupes as (\n  select cart_id, product_id, count(*) as cnt\n  from \"dwh\".\"l1\".\"carts\"\n  group by 1,2\n  having count(*) > 1\n)\nselect * from dupes", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.498610Z", "completed_at": "2025-11-07T17:11:30.519965Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.521245Z", "completed_at": "2025-11-07T17:11:30.521255Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04704022407531738, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fakestore.stg_products_l2", "compiled": true, "compiled_code": "-- ##############################################\n-- Gramedia Digital - Data Engineer Take Home Test\n-- dbt sql script for stg products in l2\n-- Mario Caesar // caesarmario87@gmail.com\n-- ##############################################\n\n\n\n\n-- L1 source\nwith src as (\n    select\n        product_id,\n        title as product_name,\n        lower(trim(category)) as category_clean,\n        price::numeric as price,\n        ds as load_ds\n    from \"dwh\".\"l1\".\"products\"\n    \n      where ds::date = '2025-11-07'::date\n    \n    \n)\nselect * from src", "relation_name": "\"dwh\".\"l2\".\"stg_products_l2\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.526200Z", "completed_at": "2025-11-07T17:11:30.534929Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.535848Z", "completed_at": "2025-11-07T17:11:30.535858Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01569509506225586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.l1_products_rating_count_nonneg", "compiled": true, "compiled_code": "-- ##############################################\n-- Gramedia Digital - Data Engineer Take Home Test\n-- dbt sql script to test l1.products rating not negative\n-- Mario Caesar // caesarmario87@gmail.com\n-- ##############################################\n\nselect *\nfrom \"dwh\".\"l1\".\"products\"\nwhere rating_count < 0", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.522418Z", "completed_at": "2025-11-07T17:11:30.535287Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.536571Z", "completed_at": "2025-11-07T17:11:30.536581Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01718759536743164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.l1_products_price_nonneg", "compiled": true, "compiled_code": "-- ##############################################\n-- Gramedia Digital - Data Engineer Take Home Test\n-- dbt sql script to test l1.products prices non neg\n-- Mario Caesar // caesarmario87@gmail.com\n-- ##############################################\n\nselect *\nfrom \"dwh\".\"l1\".\"products\"\nwhere price <= 0", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.531737Z", "completed_at": "2025-11-07T17:11:30.539919Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.551614Z", "completed_at": "2025-11-07T17:11:30.551626Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02232527732849121, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.l1_products_rating_range", "compiled": true, "compiled_code": "-- ##############################################\n-- Gramedia Digital - Data Engineer Take Home Test\n-- dbt sql script to test l1.products rating range\n-- Mario Caesar // caesarmario87@gmail.com\n-- ##############################################\n\nselect *\nfrom \"dwh\".\"l1\".\"products\"\nwhere rating_rate < 0\n   or rating_rate > 5", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.541058Z", "completed_at": "2025-11-07T17:11:30.566762Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.567461Z", "completed_at": "2025-11-07T17:11:30.567474Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.029238224029541016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.source_not_null_fakestore_l1_carts_cart_id.7362c9796f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cart_id\nfrom \"dwh\".\"l1\".\"carts\"\nwhere cart_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.556110Z", "completed_at": "2025-11-07T17:11:30.567116Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.568267Z", "completed_at": "2025-11-07T17:11:30.568276Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.029429197311401367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.source_not_null_fakestore_l1_carts_ds.1cee33192e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ds\nfrom \"dwh\".\"l1\".\"carts\"\nwhere ds is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.562622Z", "completed_at": "2025-11-07T17:11:30.569656Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.571500Z", "completed_at": "2025-11-07T17:11:30.571509Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010149240493774414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.source_not_null_fakestore_l1_carts_product_id.a4f69a69bb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom \"dwh\".\"l1\".\"carts\"\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.477399Z", "completed_at": "2025-11-07T17:11:30.570368Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.572768Z", "completed_at": "2025-11-07T17:11:30.572776Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1118316650390625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fakestore.stg_carts_l2", "compiled": true, "compiled_code": "-- ##############################################\n-- Gramedia Digital - Data Engineer Take Home Test\n-- dbt sql script for stg carts in l2\n-- Mario Caesar // caesarmario87@gmail.com\n-- ##############################################\n\n\n\n\n\n\nwith src as (\n    select\n        cart_id,\n        product_id,\n        quantity::numeric as quantity,\n\n        \n            order_date::timestamp as transaction_date,\n        \n\n        ds as load_ds\n    from \"dwh\".\"l1\".\"carts\"\n    \n      where ds::date = '2025-11-07'::date\n    \n)\nselect * from src", "relation_name": "\"dwh\".\"l2\".\"stg_carts_l2\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.574977Z", "completed_at": "2025-11-07T17:11:30.592263Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.596575Z", "completed_at": "2025-11-07T17:11:30.596586Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.025751113891601562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.source_not_null_fakestore_l1_carts_quantity.7d4da87e46", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect quantity\nfrom \"dwh\".\"l1\".\"carts\"\nwhere quantity is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.579688Z", "completed_at": "2025-11-07T17:11:30.597184Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.598662Z", "completed_at": "2025-11-07T17:11:30.598672Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.026565074920654297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.source_not_null_fakestore_l1_carts_user_id.5c10cd35bf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom \"dwh\".\"l1\".\"carts\"\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.587006Z", "completed_at": "2025-11-07T17:11:30.597730Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.599336Z", "completed_at": "2025-11-07T17:11:30.599345Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02032780647277832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.source_not_null_fakestore_l1_products_ds.73bcf0cc5e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ds\nfrom \"dwh\".\"l1\".\"products\"\nwhere ds is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.592610Z", "completed_at": "2025-11-07T17:11:30.602085Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.607445Z", "completed_at": "2025-11-07T17:11:30.607456Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01678323745727539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.source_not_null_fakestore_l1_products_price.0f9a9c2f0f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect price\nfrom \"dwh\".\"l1\".\"products\"\nwhere price is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.603539Z", "completed_at": "2025-11-07T17:11:30.618193Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.619355Z", "completed_at": "2025-11-07T17:11:30.619366Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01949000358581543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.source_not_null_fakestore_l1_products_product_id.4d4c417c4d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom \"dwh\".\"l1\".\"products\"\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.613651Z", "completed_at": "2025-11-07T17:11:30.625207Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.626666Z", "completed_at": "2025-11-07T17:11:30.626678Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.023795604705810547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.source_not_null_fakestore_l1_users_ds.c41d04a0a6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ds\nfrom \"dwh\".\"l1\".\"users\"\nwhere ds is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.609837Z", "completed_at": "2025-11-07T17:11:30.626335Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.628051Z", "completed_at": "2025-11-07T17:11:30.628060Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.025736331939697266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.source_not_null_fakestore_l1_products_title.1ee1940b1b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect title\nfrom \"dwh\".\"l1\".\"products\"\nwhere title is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.620028Z", "completed_at": "2025-11-07T17:11:30.628615Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.634064Z", "completed_at": "2025-11-07T17:11:30.634073Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016830921173095703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.source_not_null_fakestore_l1_users_email.6f85167b8f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect email\nfrom \"dwh\".\"l1\".\"users\"\nwhere email is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.629497Z", "completed_at": "2025-11-07T17:11:30.661363Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.686239Z", "completed_at": "2025-11-07T17:11:30.686263Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0605618953704834, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.source_not_null_fakestore_l1_users_user_id.87f5be58de", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom \"dwh\".\"l1\".\"users\"\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.646444Z", "completed_at": "2025-11-07T17:11:30.753132Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.755770Z", "completed_at": "2025-11-07T17:11:30.755782Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.1202392578125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.source_relationships_fakestore_l1_carts_user_id__user_id__source_fakestore_l1_users_.3484103b5d", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select user_id as from_field\n    from \"dwh\".\"l1\".\"carts\"\n    where user_id is not null\n),\n\nparent as (\n    select user_id as to_field\n    from \"dwh\".\"l1\".\"users\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.638133Z", "completed_at": "2025-11-07T17:11:30.760172Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.766451Z", "completed_at": "2025-11-07T17:11:30.766465Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.13183045387268066, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.source_relationships_fakestore_l1_carts_product_id__product_id__source_fakestore_l1_products_.1caa14cf67", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_id as from_field\n    from \"dwh\".\"l1\".\"carts\"\n    where product_id is not null\n),\n\nparent as (\n    select product_id as to_field\n    from \"dwh\".\"l1\".\"products\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.670312Z", "completed_at": "2025-11-07T17:11:30.760502Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.768370Z", "completed_at": "2025-11-07T17:11:30.768382Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.13083100318908691, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.source_unique_fakestore_l1_products_product_id.5c8eb804a7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom \"dwh\".\"l1\".\"products\"\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.749106Z", "completed_at": "2025-11-07T17:11:30.770723Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.777141Z", "completed_at": "2025-11-07T17:11:30.777152Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.030605316162109375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.source_unique_fakestore_l1_users_user_id.98893d7c1f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_id as unique_field,\n    count(*) as n_records\n\nfrom \"dwh\".\"l1\".\"users\"\nwhere user_id is not null\ngroup by user_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.772962Z", "completed_at": "2025-11-07T17:11:30.785850Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.786479Z", "completed_at": "2025-11-07T17:11:30.786491Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02404499053955078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fakestore.dim_product", "compiled": true, "compiled_code": "-- ##############################################\n-- Gramedia Digital - Data Engineer Take Home Test\n-- dbt sql script for dim product table\n-- Mario Caesar // caesarmario87@gmail.com\n-- ##############################################\n\n\n\nwith p as (\n    select\n        product_id,\n        product_name,\n        category_clean as category,\n        price,\n        max(load_ds) over (partition by product_id) as last_ingested_ds\n    from \"dwh\".\"l2\".\"stg_products_l2\"\n)\nselect distinct\n    product_id,\n    product_name,\n    category,\n    price,\n    last_ingested_ds\nfrom p", "relation_name": "\"dwh\".\"l2\".\"dim_product\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.779431Z", "completed_at": "2025-11-07T17:11:30.787087Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.787804Z", "completed_at": "2025-11-07T17:11:30.787813Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011639595031738281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fakestore.fact_sales", "compiled": true, "compiled_code": "-- ##############################################\n-- Gramedia Digital - Data Engineer Take Home Test\n-- dbt sql script for fact sales table\n-- Mario Caesar // caesarmario87@gmail.com\n-- ##############################################\n\n\n\nwith c as (\n    select * from \"dwh\".\"l2\".\"stg_carts_l2\"\n),\np as (\n    select * from \"dwh\".\"l2\".\"stg_products_l2\"\n),\njoined as (\n    select\n        -- synthetic row-level id (cart line item)\n        md5(concat_ws('||',\n            c.cart_id::text,\n            c.product_id::text,\n            coalesce(to_char(c.transaction_date,'YYYYMMDDHH24MISS'),'')\n        )) as transaction_id,\n\n        c.product_id,\n        p.product_name,\n        p.category_clean as category,\n        c.quantity,\n        p.price,\n        (c.quantity * p.price) as total_sales,\n\n        c.transaction_date,\n        c.load_ds\n    from c\n    left join p using (product_id)\n)\nselect * from joined", "relation_name": "\"dwh\".\"l2\".\"fact_sales\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.794126Z", "completed_at": "2025-11-07T17:11:30.817164Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.818258Z", "completed_at": "2025-11-07T17:11:30.818270Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028196096420288086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.not_null_dim_product_category.1cbc6e05d3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect category\nfrom \"dwh\".\"l2\".\"dim_product\"\nwhere category is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.798501Z", "completed_at": "2025-11-07T17:11:30.817744Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.819064Z", "completed_at": "2025-11-07T17:11:30.819076Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02835679054260254, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.not_null_dim_product_price.4e829203ba", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect price\nfrom \"dwh\".\"l2\".\"dim_product\"\nwhere price is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.802696Z", "completed_at": "2025-11-07T17:11:30.819675Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.821913Z", "completed_at": "2025-11-07T17:11:30.821924Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.030646324157714844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.not_null_dim_product_product_id.02b1f06816", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom \"dwh\".\"l2\".\"dim_product\"\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.806513Z", "completed_at": "2025-11-07T17:11:30.821562Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.823904Z", "completed_at": "2025-11-07T17:11:30.823913Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03208208084106445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.not_null_dim_product_product_name.1b672622d5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_name\nfrom \"dwh\".\"l2\".\"dim_product\"\nwhere product_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.831610Z", "completed_at": "2025-11-07T17:11:30.844707Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.845585Z", "completed_at": "2025-11-07T17:11:30.845598Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02237415313720703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.l2_fact_sales_price_nonneg", "compiled": true, "compiled_code": "-- ##############################################\n-- Gramedia Digital - Data Engineer Take Home Test\n-- dbt sql script to test l2.fact_sales price\n-- Mario Caesar // caesarmario87@gmail.com\n-- ##############################################\n\nselect *\nfrom \"dwh\".\"l2\".\"fact_sales\"\nwhere price < 0", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.827507Z", "completed_at": "2025-11-07T17:11:30.845169Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.846574Z", "completed_at": "2025-11-07T17:11:30.846585Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.023925065994262695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.unique_dim_product_product_id.46495bf7fe", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom \"dwh\".\"l2\".\"dim_product\"\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.836708Z", "completed_at": "2025-11-07T17:11:30.847985Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.849870Z", "completed_at": "2025-11-07T17:11:30.849879Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02312922477722168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.l2_fact_sales_quantity_positive", "compiled": true, "compiled_code": "-- ##############################################\n-- Gramedia Digital - Data Engineer Take Home Test\n-- dbt sql script to test l2.fact_sales quantity\n-- Mario Caesar // caesarmario87@gmail.com\n-- ##############################################\n\nselect *\nfrom \"dwh\".\"l2\".\"fact_sales\"\nwhere quantity <= 0", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.839576Z", "completed_at": "2025-11-07T17:11:30.848719Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.851191Z", "completed_at": "2025-11-07T17:11:30.851200Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01691722869873047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.l2_fact_sales_total_matches", "compiled": true, "compiled_code": "-- ##############################################\n-- Gramedia Digital - Data Engineer Take Home Test\n-- dbt sql script to test l2.fact_sales price logic\n-- Mario Caesar // caesarmario87@gmail.com\n-- ##############################################\n\nselect *\nfrom \"dwh\".\"l2\".\"fact_sales\"\nwhere abs(total_sales - (quantity * price)) > 1e-9", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.854039Z", "completed_at": "2025-11-07T17:11:30.874961Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.875997Z", "completed_at": "2025-11-07T17:11:30.876011Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.026894807815551758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.not_null_fact_sales_price.1fa73bdc3c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect price\nfrom \"dwh\".\"l2\".\"fact_sales\"\nwhere price is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.858851Z", "completed_at": "2025-11-07T17:11:30.875402Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.876959Z", "completed_at": "2025-11-07T17:11:30.876971Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.026464462280273438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.not_null_fact_sales_product_id.39101802a8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom \"dwh\".\"l2\".\"fact_sales\"\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.865547Z", "completed_at": "2025-11-07T17:11:30.879413Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.888031Z", "completed_at": "2025-11-07T17:11:30.888049Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03003239631652832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.not_null_fact_sales_quantity.123217c37f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect quantity\nfrom \"dwh\".\"l2\".\"fact_sales\"\nwhere quantity is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.869559Z", "completed_at": "2025-11-07T17:11:30.885722Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.891273Z", "completed_at": "2025-11-07T17:11:30.891287Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.028477191925048828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.not_null_fact_sales_total_sales.2feb308531", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_sales\nfrom \"dwh\".\"l2\".\"fact_sales\"\nwhere total_sales is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.899368Z", "completed_at": "2025-11-07T17:11:30.917353Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.917886Z", "completed_at": "2025-11-07T17:11:30.917922Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028259754180908203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.not_null_fact_sales_transaction_id.bd882dea40", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transaction_id\nfrom \"dwh\".\"l2\".\"fact_sales\"\nwhere transaction_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.893440Z", "completed_at": "2025-11-07T17:11:30.919314Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.920759Z", "completed_at": "2025-11-07T17:11:30.920771Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03595161437988281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.not_null_fact_sales_transaction_date.46fa352ad2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transaction_date\nfrom \"dwh\".\"l2\".\"fact_sales\"\nwhere transaction_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.912809Z", "completed_at": "2025-11-07T17:11:30.920382Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.921814Z", "completed_at": "2025-11-07T17:11:30.921823Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.016632080078125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.unique_fact_sales_transaction_id.b8f21504c7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    transaction_id as unique_field,\n    count(*) as n_records\n\nfrom \"dwh\".\"l2\".\"fact_sales\"\nwhere transaction_id is not null\ngroup by transaction_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-07T17:11:30.907560Z", "completed_at": "2025-11-07T17:11:30.921520Z"}, {"name": "execute", "started_at": "2025-11-07T17:11:30.922772Z", "completed_at": "2025-11-07T17:11:30.922783Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.024309635162353516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.fakestore.relationships_fact_sales_product_id__product_id__ref_dim_product_.b833249307", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_id as from_field\n    from \"dwh\".\"l2\".\"fact_sales\"\n    where product_id is not null\n),\n\nparent as (\n    select product_id as to_field\n    from \"dwh\".\"l2\".\"dim_product\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 0.5440125465393066, "args": {"require_explicit_package_overrides_for_builtin_materializations": true, "compile": true, "log_format": "default", "introspect": true, "validate_macro_args": false, "use_colors": true, "favor_state": false, "skip_nodes_if_on_run_start_fails": false, "static_parser": true, "version_check": true, "static": false, "show_resource_report": false, "state_modified_compare_vars": false, "log_level_file": "debug", "defer": false, "source_freshness_run_project_hooks": true, "partial_parse": true, "profiles_dir": "/dbt", "log_format_file": "debug", "empty_catalog": false, "cache_selected_only": false, "require_nested_cumulative_type_params": false, "upload_to_artifacts_ingest_api": false, "vars": {"batch_ds": "2025-11-07"}, "partial_parse_file_diff": true, "which": "generate", "invocation_command": "dbt docs generate --vars {batch_ds: \"2025-11-07\"}", "quiet": false, "project_dir": "/dbt", "require_all_warnings_handled_by_warn_error": false, "target": "dev", "write_json": true, "send_anonymous_usage_stats": true, "use_fast_test_edges": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "printer_width": 80, "require_batched_execution_for_custom_microbatch_strategy": false, "print": true, "require_resource_names_without_spaces": true, "macro_debugging": false, "select": [], "require_generic_test_arguments_property": true, "exclude": [], "state_modified_compare_more_unrendered_values": false, "log_file_max_bytes": 10485760, "populate_cache": true, "strict_mode": false, "show_all_deprecations": false, "log_level": "info", "use_colors_file": true, "log_path": "/dbt/logs", "indirect_selection": "eager", "require_yaml_configuration_for_mf_time_spines": false}}