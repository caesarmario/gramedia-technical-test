{
  "_meta": {
    "input_path": "data",
    "explode": null,
    "strict": true
  },
  "select": {
    "user_id":        { "path": "id",                  "type": "int" },
    "username":       { "path": "username",            "type": "string" },
    "email":          { "path": "email",               "type": "string" },
    "phone":          { "path": "phone",               "type": "string" },

    "first_name":     { "path": "name.firstname",      "type": "string" },
    "last_name":      { "path": "name.lastname",       "type": "string" },

    "address_street": { "path": "address.street",      "type": "string" },
    "address_number": { "path": "address.number",      "type": "int" },
    "address_city":   { "path": "address.city",        "type": "string" },
    "address_zip":    { "path": "address.zipcode",     "type": "string" },
    "geo_lat":        { "path": "address.geolocation.lat",  "type": "float", "default": null },
    "geo_lng":        { "path": "address.geolocation.long", "type": "float", "default": null }
  },
  "derive": {
    "full_name":   { "op": "concat_ws", "args": [" ", "first_name", "last_name"] },
    "email_domain":{ "op": "split_part", "args": ["email", "@", 2] }
  },
  "fillna": {
    "address_city": "",
    "address_zip":  ""
  },
  "validations": {
    "not_null": ["user_id", "username", "email"],
    "unique":   ["user_id"]
  },
  "order": [
    "user_id", "username", "email", "email_domain", "phone",
    "first_name", "last_name", "full_name",
    "address_street", "address_number", "address_city", "address_zip",
    "geo_lat", "geo_lng"
  ]
}
